<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Risk: 25 highest</title>
    <link rel="stylesheet" href="/sites/all/libraries/jquery-ui-1.11.1/jquery-ui.min.css" />
    <script type="text/javascript" src="/sites/all/libraries/jquery-ui-1.11.1/external/jquery/jquery.js"></script>
    <script type="text/javascript" src="/sites/all/libraries/jquery-ui-1.11.1//jquery-ui.min.js"></script>

    <script type="text/javascript" src="/sites/all/libraries/Highcharts-4.0.4/js/highcharts.js"></script>


    <script type="text/javascript" src="/sites/all/libraries/Highcharts-4.0.4/js/highcharts-more.js"></script>

    <script type="text/javascript" src="/iframes/common/js/lmes.js"></script>
    </meta>


    <!-- local css -->
    <style>
     body {
       font-family:Verdana, sans-serif!important;
     }
     h1 {
       text-align:center;
     }
     h2 {
       text-align:center;
     }

     .dataTable table {
       border-collapse:collapse;
       width:100%;
     }
     .dataTable td {
       padding:0px;
     }
     .dataTable td,tr,th {
       font-family:Verdana, sans-serif;
       font-size:14px;
       text-align:left;
       vertical-align:bottom;
     }

    </style>

    <!-- ready function -->
    <script type="text/javascript">
     $(document).ready(function() {

       dataVal=[];

       dataVal[0]=["China",0.420333839,0.537526841,1,0.609066673];
       dataVal[1]=["India",0.620637329,0.392419223,0.892462556,0.601255955];
       dataVal[2]=["Indonesia",0.468892261,0.330068803,0.688470084,0.474082807];
       dataVal[3]=["Philippines",0.503793627,0.418538483,0.289500565,0.393742681];
       dataVal[4]=["Bangladesh",0.66616085,0.319622415,0.240432108,0.371309676];
       dataVal[5]=["Viet Nam",0.537177542,0.398778482,0.221106212,0.361812446];
       dataVal[6]=["Nigeria",0.742033384,0.468275547,0.112483515,0.339368296];
       dataVal[7]=["Brazil",0.373292868,0.362400106,0.285984649,0.338215555];
       dataVal[8]=["Egypt",0.464339909,0.456830365,0.115146594,0.290144287];
       dataVal[9]=["Japan",0.151745068,0.405215953,0.388202126,0.287929619];
       dataVal[10]=["Morocco",0.572078907,0.493724747,0.066042539,0.265208963];
       dataVal[11]=["Myanmar",0.71016692,0.350800069,0.07246963,0.262336498];
       dataVal[12]=["Algeria",0.414264036,0.482840378,0.076995254,0.248798786];
       dataVal[13]=["Pakistan",0.690440061,0.416440348,0.052772785,0.247569001];
       dataVal[14]=["U.S.A.",0.115326252,0.291895009,0.406864842,0.239259029];
       dataVal[15]=["Thailand",0.408194234,0.358075259,0.086264069,0.232750366];
       dataVal[16]=["U.K and N. Ireland" ,0.138088012,0.517291439,0.173404492,0.231375412];
       dataVal[17]=["Malaysia",0.330804249,0.431340529,0.084288402,0.229114753];
       dataVal[18]=["Mozambique",0.91198786,0.319598657,0.040976482,0.228582455];
       dataVal[19]=["Yemen",0.748103187,0.347662691,0.044154988,0.225614212];
       dataVal[20]=["Rep. of Korea",0.151745068,0.489929761,0.148605804,0.222721116];
       dataVal[21]=["Sri Lanka",0.371775417,0.473071468,0.062305316,0.222114806];
       dataVal[22]=["South Africa",0.517450683,0.347436652,0.059707246,0.2205924];
       dataVal[23]=["Haiti",0.787556904,0.42311683,0.031506464,0.218967993];
       dataVal[24]=["Italy",0.171471927,0.423446283,0.14298746,0.218153961];

       Highcharts.Risk = function(optionsIn, callback){
         var defaultOptions = {
           chart:{
             renderTo:(optionsIn.chart && optionsIn.chart.renderTo) || this,
             polar:false,
             width:150,
             height:80,
	     spacingBottom:5,
	     spacingTop:5,
	     spacingLeft:0,
	     spacingRight:0
           },
           colors:['#2f7ed8','#910000','#8bbc21'],
           credits:{enabled:false},
           xAxis:{
             categories:['1-HDI','CHI','Pop.'],
             labels:{enabled:false},
             minorGridLineWidth:0,
             lineColor:'transparent',
             minorTickLength:0,
             tickLength:0,
             title:{text:null}},
           yAxis:{min:0, max:1, title:null, tickInterval:0.5},
           tooltip:{formatter:function(){return '<b>'+this.x+': </b>'+this.y.toFixed(3)}},

           plotOptions:{column:{colorByPoint:true}},
         };
         options = Highcharts.merge(defaultOptions, optionsIn);
         return new Highcharts.Chart(options, callback);
       }

       Highcharts.Level = function(optionsIn, callback){
         var defaultOptions={
           chart:{
             renderTo:(optionsIn.chart && optionsIn.chart.renderTo) || this,
	     polar:false,
	     width:100,
	     height:80
           },
	   colors:['#F0C000'],
	   credits:{enabled:false},
	   yAxis:{min:0, max:1, tickInterval:0.5, tickPosition:'inside', labels:{enabled:true}, opposite:true,title:{text:null}},
	   xAxis:{categories:['Risk'], title:{text:null}, labels:{enabled:false}},
	   title:{text:null},
	   subtitle:{text:null},
	   plotOptions:{bar:{colorByPoint:false}}
         }

         options = Highcharts.merge(defaultOptions, optionsIn);
         return new Highcharts.Chart(options, callback);
       };

       var ipos=0;
       var table=$('<table></table>').addClass('dataTable');
       var head=$('<tr><th>Country</th><th>Risk</th><th>1-HDI, CHI, Population</th></tr>');
       table.append(head);
       for (jj=0; jj<25; jj++) {
         var row=$('<tr></tr>').addClass('dataTable').text('');
         var refCode="chart_"+ipos;
         var cell=$('<td style="width:90px">'+dataVal[ipos][0]+':<br/>'+dataVal[ipos][4].toFixed(3)+'</td>');
         row.append(cell);
         cell=$('<td style="width:60px; padding-right:20px" data-series="'+dataVal[ipos][4]+'"></td>');
         row.append(cell);
         cell=$('<td data-chart="'+dataVal[ipos][0]+', '+dataVal[ipos][1]+', '+dataVal[ipos][2]+', '+dataVal[ipos][3]+', '+dataVal[ipos][4]+'"></td>').addClass('dataTable').text('');
         row.append(cell);

         ipos+=1;

         table.append(row);

       }

       $('#dataTable').append(table);

       $tds = $("td[data-series]");
       for (ii=0; ii< $tds.length; ii++){
	 $td=$($tds[ii]);
	 thisdata=parseFloat($td.data('series'));
	 mychart={type:'bar'};
	 $td.highcharts('Level', {
	   series:[{data:[thisdata], showInLegend:false}],
	   chart:mychart,
	 });
       }


       $tds = $("td[data-chart]");
       for (ii=0; ii< $tds.length; ii++){
         $td=$($tds[ii]);
         stringdata = $td.data('chart');
         dataDecode=$.map(stringdata.split(', '), parseFloat);
         dataName=stringdata.split(',')[0];
         data=dataDecode.slice(1,4);
         chart={};
         $td.highcharts('Risk',{
           series:[{data:data, type:'column', showInLegend:false}],
           chart:chart,
           //title:{text:dataName, useHTML:true, style:{fontSize:"10px",fontFamily:"Verdana,sans-serif",fontWeight:"normal"}},
           title:{text:null},
           subtitle:{text:null}
         });
       }

     });
    </script>


    <body>
      <h1>25 countries most exposed to risk</h1>
      <h2>
        <span style="background-color:#8bbc21">&nbsp;&nbsp;&nbsp;&nbsp;</span> Population &nbsp;
        <span style="background-color:#910000">&nbsp;&nbsp;&nbsp;&nbsp;</span> CHI &nbsp;
        <span style="background-color:#2F7ed8">&nbsp;&nbsp;&nbsp;&nbsp;</span> 1-HDI
      </h2>
      <div style="clear:both"></div>

      <div style="width:350px; margin:auto;" id="dataTable"> </div>

    </body>

  </head>
</html>